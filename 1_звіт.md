# Київський національний університет імені Тараса Шевченка  
## Механіко-математичний факультет  

### САМОСТІЙНА РОБОТА  
з курсу  
**«ВСТУП ДО СТАТИСТИКИ»**  

на тему:  
**«Проста лінійна регресія»**

Виконала:  
студентка 2 курсу  
спеціальності «Статистика»  
**Рибакова Альона**

---

## Пункт 1. Збір даних

Для виконання роботи було використано сайт **numbeo.com**.  
На вказаному ресурсі були знайдені актуальні значення цін на два обрані товари/послуги:

- вартість мобільного тарифу (*Mobile Phone Monthly Plan*);
- вартість абонемента у фітнес-клубі (*Fitness Club, Monthly Fee for 1 Adult*).

Дані зібрано для десяти міст Європи відповідно до індивідуального варіанту завдання.  
Отримані значення були вручну перенесені до текстової таблиці та збережені у вигляді окремого файлу для подальшого аналізу в середовищі **R**.

---

## Пункт 2. Зчитування даних у R

```r
# --- Setup ---
dirs <- c("data","plots","outputs")
for(d in dirs) if(!dir.exists(d)) dir.create(d, recursive=TRUE, showWarnings=FALSE)

# --- Дані ---
City <- c("Paris","Orleans","London","Edinburgh","Rome","Milan",
          "Berlin","Munich","Madrid","Barcelona")
Mobile <- c(13.77,16.88,13.89,13.29,10.12,9.94,15.09,15.16,16.76,17.79)
Fitness <- c(39.24,27.67,52.50,38.36,59.94,71.56,32.19,42.65,45.02,48.62)

data <- data.frame(City, Mobile, Fitness)

# Збереження таблиці
write.table(data, file="data/mobile_fitness.txt", row.names=FALSE)

# Перевірка структури даних
str(data)
summary(data)
png("plots/scatter_mobile_fitness.png", width=900, height=650)

plot(data$Mobile, data$Fitness,
     pch=19, col="darkred",
     xlab="Mobile (monthly plan)",
     ylab="Fitness (monthly fee)")

text(data$Mobile, data$Fitness,
     labels=data$City, pos=2, col="blue")

dev.off()
mx <- mean(data$Mobile)
my <- mean(data$Fitness)

b1_analytic <- sum((data$Mobile - mx)*(data$Fitness - my)) /
               sum((data$Mobile - mx)^2)
b0_analytic <- my - b1_analytic * mx

cat(sprintf("b0 = %.4f, b1 = %.4f\n", b0_analytic, b1_analytic))
fit <- lm(Fitness ~ Mobile, data=data)
coef(fit)

capture.output(summary(fit), file="outputs/lm_summary.txt")
png("plots/scatter_with_lm.png", width=900, height=650)

plot(data$Mobile, data$Fitness,
     pch=19, col="darkred",
     xlab="Mobile (monthly plan)",
     ylab="Fitness (monthly fee)")

text(data$Mobile, data$Fitness,
     labels=data$City, pos=2, col="blue")

abline(coef(fit), col="red", lwd=2)

dev.off()
cooks <- cooks.distance(fit)
hatv  <- hatvalues(fit)
rstd  <- rstandard(fit)

most_inf_idx  <- which.max(cooks)
most_inf_city <- data$City[most_inf_idx]

most_inf_city
data_minus <- data[-most_inf_idx, ]
fit_minus <- lm(Fitness ~ Mobile, data=data_minus)

coef(fit_minus)


Висновки

У ході виконання роботи було досліджено залежність між вартістю мобільного тарифу та вартістю абонемента у фітнес-клубі в різних містах Європи.
Отримані результати свідчать про наявність лінійної залежності між цими показниками: у містах з вищою вартістю мобільного зв’язку, як правило, вищими є і витрати на фітнес.

Побудована модель простої лінійної регресії підтверджує економічну інтуїцію та демонструє практичне застосування методів математичної статистики для аналізу реальних даних.